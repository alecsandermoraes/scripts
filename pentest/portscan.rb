require 'optparse'
require 'socket'

options = {}
basefile = File.basename(__FILE__)
OptionParser.new do |opts| 
    opts.banner = "Usage: ruby #{basefile} [options]"

    opts.on("-dDOMAIN", "--domain=DOMAIN", "Domain") do |domain| 
        options[:domain] = domain 
    end 
end.parse! 

unless options[:domain]
    puts "Forneça os Argumentos Corretamente"
    exit 
end 

ports = [20, 21, 22, 25, 53, 80, 123, 179, 443, 500, 587, 3389]
puts "Escaneando: #{options[:domain]}\n"

begin 
    ports.each do |port|
        begin 
            client = TCPSocket.new(options[:domain], port)
            puts "#{port} -> OPEN"
            client.close 
        rescue Errno:ECONNREFUSED, Errno:ETIMEDOUT
            next 
        end 
    end 
rescue SocketError 
    puts "\e[0;40;31m[-] URL Inválida\e[m"
end 
