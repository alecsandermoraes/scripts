require 'optparse'
require 'resolv'

options = {}
basefile = File.basename(__FILE__)
OptionParser.new do |opts| 
    opts.banner = "Usage: ruby #{basefile} [options]"

    opts.on("-wWORDLIST", "--wordlist=WORDLIST", "Wordlist File") do |wordlist|
        options[:wordlist] = wordlist 
    end 

    opts.on("-dDOMAIN", "--domain=DOMAIN", "Domain") do |domain|
        options[:domain] = domain 
    end 
end.parse! 

unless options[:wordlist] && options[:domain]
    puts "ForneÃ§a os Argumentos Corretamente"
    exit 
end 

res = Resolv::DNS.new 
File.open(options[:wordlist], 'r').each_line do |subdomain|
    subdomain.chomp!
    begin
        sub_target = "#{subdomain}.#{options[:domain]}"
        result = res.getaddresses(sub_target)
        result.each do |ip| 
            puts "#{sub_target} -> #{ip}"
        end 
    rescue Resolv::ResolvError => e 
        next 
    end 
end 
