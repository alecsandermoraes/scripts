import 'dart:io';

void main(List<String> args) {
    String? wordlist;
    String? domain;

    for (int i = 0; i < args.length; i++) {
        if (args[i] == "-w" && i + 1 < args.length) {
            wordlist = args[i + 1];
        } else if (args[i] == "-d" && i + 1 < args.length) {
            domain = args[i + 1];
        }
    }

    if (wordlist == null || domain == null) {
        print("ForneÃ§a os Argumentos Corretamente");
        return;
    }

    final resolver = InternetAddress.lookup;
    final file = File(wordlist);

    file.readAsLines().then((List<String> lines) {
        lines.forEach((String subdomain) async {
            String subTarget = '$subdomain.$domain';
            try {
                List<InternetAddress> addresses = await resolver(subTarget);
                addresses.forEach((InternetAddress address) {
                    print('$subTarget -> ${address.address}');
                });
            } catch (e) {
                print('Erro');
            }
        });
    }).catchError((e) {
        print('Erro ao Abrir a Wordlist');
    });
}
