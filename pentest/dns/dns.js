const dns = require('dns');
const fs = require('fs');

let wordlist;
let domain; 

for (let i = 2; i < process.argv.length; i++) {
    if (process.argv[i] === '-w' && i + 1 < process.argv.length) {
        wordlist = process.argv[i + 1];
    } else if (process.argv[i] === '-d' && i + 1 < process.argv.length) {
        domain = process.argv[i + 1];
    }
}

if (!wordlist || !domain) {
    console.log('ForneÃ§a os Argumentos Corretamente');
    process.exit(1);
}

fs.readFile(wordlist, 'utf8', (err, data) => {
    if (err) {
        console.log("Erro ao Abrir a Wordlist");
        process.exit(1);
    }

    const lines = data.trim().split('\n');
    lines.forEach(subdomain => {
        const subTarget = `${subdomain.trim()}.${domain}`;
        dns.resolve(subTarget, (err, addresses) => {
            if (err) { return }
            addresses.forEach(address => {
                console.log(`${subTarget} -> ${address}`);
            });
        });
    });
});

